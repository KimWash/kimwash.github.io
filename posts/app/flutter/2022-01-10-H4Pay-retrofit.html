<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>H4Pay 개발기 - Retrofit, 드디어 적용하다 | Wh@t !s Development?</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-C7NTCRQ25E"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C7NTCRQ25E');</script>
    <meta name="description" content="배워가고 있는 현업..? 대학생 개발자">
    
    <link rel="preload" href="/assets/css/0.styles.d0292b10.css" as="style"><link rel="preload" href="/assets/js/app.ddc79771.js" as="script"><link rel="preload" href="/assets/js/1.00a05d18.js" as="script"><link rel="preload" href="/assets/js/43.b3315ca4.js" as="script"><link rel="prefetch" href="/assets/js/10.dfcccddd.js"><link rel="prefetch" href="/assets/js/11.6b83b439.js"><link rel="prefetch" href="/assets/js/12.d56c10e2.js"><link rel="prefetch" href="/assets/js/13.9a7e722a.js"><link rel="prefetch" href="/assets/js/14.c77e849e.js"><link rel="prefetch" href="/assets/js/15.6edac085.js"><link rel="prefetch" href="/assets/js/16.4aa95d0a.js"><link rel="prefetch" href="/assets/js/17.b6aa454d.js"><link rel="prefetch" href="/assets/js/18.c63b30d1.js"><link rel="prefetch" href="/assets/js/19.ac53068d.js"><link rel="prefetch" href="/assets/js/2.f29d7a36.js"><link rel="prefetch" href="/assets/js/20.ca4439f5.js"><link rel="prefetch" href="/assets/js/21.e494406c.js"><link rel="prefetch" href="/assets/js/22.2c5c23b6.js"><link rel="prefetch" href="/assets/js/23.46ee9f2a.js"><link rel="prefetch" href="/assets/js/24.dae06283.js"><link rel="prefetch" href="/assets/js/25.57ee23f4.js"><link rel="prefetch" href="/assets/js/26.fa87e3a1.js"><link rel="prefetch" href="/assets/js/27.8bad4a4a.js"><link rel="prefetch" href="/assets/js/28.c022dafb.js"><link rel="prefetch" href="/assets/js/29.832754dd.js"><link rel="prefetch" href="/assets/js/30.d6e6a2b7.js"><link rel="prefetch" href="/assets/js/31.e58352c6.js"><link rel="prefetch" href="/assets/js/32.3cf6010b.js"><link rel="prefetch" href="/assets/js/33.dbf0acb0.js"><link rel="prefetch" href="/assets/js/34.c86bebc8.js"><link rel="prefetch" href="/assets/js/35.ed0db922.js"><link rel="prefetch" href="/assets/js/36.fe356a5e.js"><link rel="prefetch" href="/assets/js/37.10850e5b.js"><link rel="prefetch" href="/assets/js/38.2dcc607c.js"><link rel="prefetch" href="/assets/js/39.7c0f35e0.js"><link rel="prefetch" href="/assets/js/4.1ba239d4.js"><link rel="prefetch" href="/assets/js/40.8b87d3bf.js"><link rel="prefetch" href="/assets/js/41.f30deeb0.js"><link rel="prefetch" href="/assets/js/42.57b77ea8.js"><link rel="prefetch" href="/assets/js/44.b17508ca.js"><link rel="prefetch" href="/assets/js/45.5b5c19a7.js"><link rel="prefetch" href="/assets/js/46.9e8ce819.js"><link rel="prefetch" href="/assets/js/47.28b35706.js"><link rel="prefetch" href="/assets/js/48.c0d87fd4.js"><link rel="prefetch" href="/assets/js/49.a1b41e8c.js"><link rel="prefetch" href="/assets/js/5.4eb38bec.js"><link rel="prefetch" href="/assets/js/50.8bba066d.js"><link rel="prefetch" href="/assets/js/51.8cf81ea4.js"><link rel="prefetch" href="/assets/js/52.a18442c1.js"><link rel="prefetch" href="/assets/js/53.9c4363f6.js"><link rel="prefetch" href="/assets/js/54.aa373bcf.js"><link rel="prefetch" href="/assets/js/55.71982d82.js"><link rel="prefetch" href="/assets/js/56.5abff6bf.js"><link rel="prefetch" href="/assets/js/57.0b66cd56.js"><link rel="prefetch" href="/assets/js/58.100b73b8.js"><link rel="prefetch" href="/assets/js/59.d9855a7f.js"><link rel="prefetch" href="/assets/js/6.d4f3d3fa.js"><link rel="prefetch" href="/assets/js/60.9e38f4e1.js"><link rel="prefetch" href="/assets/js/61.af4308f2.js"><link rel="prefetch" href="/assets/js/62.ccf1ac4f.js"><link rel="prefetch" href="/assets/js/63.c993d191.js"><link rel="prefetch" href="/assets/js/64.4471c1d1.js"><link rel="prefetch" href="/assets/js/65.e293c8a4.js"><link rel="prefetch" href="/assets/js/66.a2258361.js"><link rel="prefetch" href="/assets/js/67.b465570a.js"><link rel="prefetch" href="/assets/js/68.f5faede9.js"><link rel="prefetch" href="/assets/js/69.c5c7f24b.js"><link rel="prefetch" href="/assets/js/7.48b87eb4.js"><link rel="prefetch" href="/assets/js/70.a96c8ea1.js"><link rel="prefetch" href="/assets/js/71.6699ca68.js"><link rel="prefetch" href="/assets/js/72.cd05fcfb.js"><link rel="prefetch" href="/assets/js/73.6570ccec.js"><link rel="prefetch" href="/assets/js/74.6d9157b7.js"><link rel="prefetch" href="/assets/js/75.8b8f1b93.js"><link rel="prefetch" href="/assets/js/76.a1c0b7d3.js"><link rel="prefetch" href="/assets/js/77.e2237a8d.js"><link rel="prefetch" href="/assets/js/78.36aa1e85.js"><link rel="prefetch" href="/assets/js/79.92afca59.js"><link rel="prefetch" href="/assets/js/8.307db6b1.js"><link rel="prefetch" href="/assets/js/80.46b201f7.js"><link rel="prefetch" href="/assets/js/81.9939db5b.js"><link rel="prefetch" href="/assets/js/82.431ad0b8.js"><link rel="prefetch" href="/assets/js/83.2f42c6fa.js"><link rel="prefetch" href="/assets/js/84.156f49d3.js"><link rel="prefetch" href="/assets/js/85.f34a6202.js"><link rel="prefetch" href="/assets/js/86.060681ff.js"><link rel="prefetch" href="/assets/js/87.ddb48362.js"><link rel="prefetch" href="/assets/js/9.f92da099.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d0292b10.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="layout"><div id="navbar"><nav role="navigation" aria-label="main navigation" class="navbar"><div class="navbar-brand"><a href="/" class="navbar-item" style="font-weight:bold;color:black;">
      Wh@t !s Development?
    </a><a role="button" aria-label="menu" tabindex="0" class="navbar-burger burger"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div class="navbar-menu"><div class="navbar-start"></div><div class="navbar-end"><a href="/" class="navbar-item">
      Home
    </a><a href="/about" class="navbar-item">
      About
    </a> <a href="/posts/app" class="navbar-item">
      앱
    </a><a href="/posts/cs" class="navbar-item">
      CS
    </a><a href="/posts/web" class="navbar-item">
      Web
    </a><a href="/posts/etc" class="navbar-item">
      그 외
    </a> <div class="navbar-item"><div class="buttons"><button type="button" class="button is-info"><!----><!----><span class="icon is-small"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="svg-inline--fa fa-github fa-w-16"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span></button> <button type="button" class="button is-info"><!----><!----><span class="icon is-small"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-instagram fa-w-14"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></span></button> <button type="button" class="button is-info"><!----><span><span class="icon is-small"><img src="/images/white_notion.svg" width="15" height="15"></span></span><!----></button></div></div></div></div></nav></div> <div class="content"><div class="page post"><div class="columns"><div class="column"><p class="title is-4">H4Pay 개발기 - Retrofit, 드디어 적용하다</p></div> <div class="column is-2"><p class="subtitle is-5 date">2022-01-10</p></div></div> <div class="content__default" style="paddig:0;"><h4 id="⚠️-경고">⚠️ 경고</h4> <blockquote><p>이 글은 Retrofit의 사용법보다는 개인의 경험을 중심적으로 서술해놓았습니다. 감안하고 읽어주셨으면 합니다.</p></blockquote> <h4 id="retrofit이-뭔데">Retrofit이 뭔데?</h4> <p><img src="https://blog.kakaocdn.net/dn/dp0clO/btqNMNsUs4c/uIt6J39kVlDx0KqnNfOoMK/img.png" alt="Retrofit logo"></p> <p>Retrofit에 대한 정의나 설명은 다른 훌륭한 분들이 적어놓으셨다. <a href="https://todaycode.tistory.com/38" target="_blank" rel="noopener noreferrer">여기<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>에 의하면 &quot;서버와 클라이언트 간 http 통신을 위한 라이브러리&quot; 라고 하는데.. 내가 이해한 바에 의하면 그것을 도와주는 라이브러리에 더 가까웠다. 왜냐하면 Retrofit도 결국 클라이언트로는 OkHttp를 사용하고 있기 때문이다. 근데 굳이 이걸 쓰는 이유는, 심각하게 코드를 단축시킬 수 있기 때문이다.</p> <h4 id="자기반성-time">자기반성 Time</h4> <p>나는 나름 실제 프로덕트를 개발하고 있음에도 정말이지 &quot;끔찍하다&quot;라는 말이 아깝지 않게 진행해왔다. 아래는 주문번호를 이용해 주문 데이터를 불러오는 API를 호출하는 부분이다. 극혐 삼박자가 딱 맞아 떨어진다.</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> result <span class="token operator">=</span>
  <span class="token function">Get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">BuildConfig<span class="token punctuation">.</span>API_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/orders/fromorderId/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">passedOrderId</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showServerError</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;status&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      purchase <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getJSONObject</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;order&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">,</span>
        <span class="token string-literal singleline"><span class="token string">&quot;불러오지 못했습니다!&quot;</span></span><span class="token punctuation">,</span>
        Toast<span class="token punctuation">.</span>LENGTH_SHORT
      <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>조금만 알면 바로 문제가 보이시리라고 생각되지만, 스스로 복기하기 위해무엇이 문제인지 적어본다..</p> <ol><li>deprecate된 AsyncTask를 쓰고 있다. 하하...</li> <li>있을지 없을지 확실하지 않은 field를 불러오고 있다.</li> <li>제일 심각한, <strong>예외 처리가 안돼있다.</strong></li></ol> <p><img src="https://media3.giphy.com/media/kBI5aLB6wlw4zNnecN/giphy.gif?cid=ecf05e473l19xepe1rrq40b4uuqkbkfi75d0b8en0qtw7bdn&amp;rid=giphy.gif&amp;ct=g" alt="uh..."></p> <h4 id="사실-오래전부터-널-지켜보고-있었어">사실.. 오래전부터 널 지켜보고 있었어..</h4> <p>Retrofit이 안드로이드에서 많이 쓰이는 건 알고 있었다. 하지만 적용해보지 못한 이유 중 하나가, 우리 백엔드 API의 데이터 구조다. response body를 파싱하면 status, message, result key가 있고 실제 결과값은 result key에 대응되는 구조라서 result의 데이터형에 따라 경우의 수가 나뉘어서 짜증난다. 사실 관련 자료가 많이 나와 있는데 검색을 열심히 해보지 않았던 것 같다. 또 다시 반성한다..</p> <blockquote><p>문제 해결에 <a href="https://medium.com/mj-studio/%EC%84%9C%EB%B2%84-%EC%9D%91%EB%8B%B5-cherry-pick-okhttp-interceptor-eaafa476dc4d" target="_blank" rel="noopener noreferrer">이 글<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>의 도움을 많이 받았다. 감사합니다 😅</p></blockquote> <h4 id="큰-흐름">큰 흐름</h4> <p>위의 솔루션을 몰랐을 때는 그냥 Response 클래스에 result:T?를 지정해두고 진행하려고 하다보니 직렬화가 사실상 불가능하다는걸 깨닿고, 다시 검색을 해보기로 했다. 그 결과 위의 글을 발견했다.
큰 흐름은 다음과 같다.</p> <ol><li>OkHttp의 기능 중 하나인 Interceptor를 이용해 response를 중간에 intercept한다.</li></ol> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> client <span class="token operator">=</span> OkHttpClient<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token punctuation">.</span><span class="token function">addNetworkInterceptor</span><span class="token punctuation">(</span>networkInterceptor<span class="token punctuation">)</span> 
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>그 response를 ResponseWrapper 객체로 만들고, ResponseWrapper의 result를 역직렬화 한 다음 새로운 response body에 집어넣는다.</li></ol> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> type <span class="token operator">=</span> <span class="token keyword">object</span><span class="token operator">:</span>TypeToken<span class="token operator">&lt;</span>ResponseWrapper<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>type  
<span class="token keyword">val</span> res <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token punctuation">{</span>  
    <span class="token keyword">val</span> result <span class="token operator">=</span> gson<span class="token punctuation">.</span>fromJson<span class="token operator">&lt;</span>ResponseWrapper<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>rawJsonResponse<span class="token punctuation">,</span> type<span class="token punctuation">)</span> <span class="token operator">?:</span> <span class="token keyword">throw</span> <span class="token function">JsonParseException</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Failed to parse json&quot;</span></span><span class="token punctuation">)</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>status<span class="token punctuation">)</span> ResponseWrapper<span class="token operator">&lt;</span>Any<span class="token operator">&gt;</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>code<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">else</span> result  
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span>JsonParseException<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">ResponseWrapper</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">900</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;Failed to parse json&quot;</span></span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>t<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">ResponseWrapper</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">901</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;Unknown Error&quot;</span></span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="3"><li>해당 response body를 반환해준다.</li></ol> <p>사실 생각보다 간단하다. 중간에 처리를 해주는 중간자를 넣는 것 뿐이다.</p> <h4 id="이제-플러터에도-적용해볼까">이제 플러터에도 적용해볼까?</h4> <p>Flutter용 Retrofit에서 사용하는 클라이언트, dio에서도 interceptor를 지원한다. 다음 포스트 소재가 될 것 같다.</p></div> <div id="disqus_thread" class="comment"></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ddc79771.js" defer></script><script src="/assets/js/1.00a05d18.js" defer></script><script src="/assets/js/43.b3315ca4.js" defer></script>
  </body>
</html>
